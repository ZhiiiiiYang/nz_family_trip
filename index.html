<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    
    <!-- App Icon & Title (iOS Home Screen) -->
    <meta name="apple-mobile-web-app-title" content="NZ Family Trip">
    <link rel="apple-touch-icon" sizes="128x128" href="icon3.png">
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="shortcut icon" type="image/png" href="icon.png">

    <title>紐西蘭南北島・家族大旅行</title>
    
    <!-- FontAwesome (Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <!-- App Logic -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('itineraryApp', () => ({
                activeTab: 'itinerary',
                openDay: 0, 
                currentDayNum: 1,
                
                // Ledger Data
                ledger: JSON.parse(localStorage.getItem('nz_ledger')) || [
                    {id: 1, name: '米佛峽灣遊船', cost: 570},
                    {id: 2, name: 'RealNZ 螢火蟲洞', cost: 2360},
                    {id: 3, name: '企鵝歸巢', cost: 735},
                    {id: 4, name: 'Heritage 農場', cost: 855},
                    {id: 5, name: '終極樹冠之旅', cost: 4613},
                    {id: 6, name: '空中纜車+滑板車', cost: 1629},
                    {id: 7, name: 'ZORB 水球', cost: 1692},
                    {id: 8, name: '凱庫拉賞鯨', cost: 0} 
                ],
                newEntryName: '',
                newEntryCost: '',

                // Weather Data
                weatherSouth: [
                    {day: '今天', icon: 'fa-sun', temp: '18°C', desc: '基督城/晴朗'},
                    {day: '明天', icon: 'fa-cloud-sun', temp: '16°C', desc: '蒂卡波/多雲'},
                    {day: '週三', icon: 'fa-cloud-rain', temp: '14°C', desc: '峽灣/有雨'},
                ],
                weatherNorth: [
                    {day: '今天', icon: 'fa-sun', temp: '24°C', desc: '奧克蘭/熱'},
                    {day: '明天', icon: 'fa-sun', temp: '25°C', desc: '羅托魯瓦/晴'},
                    {day: '週三', icon: 'fa-cloud-sun', temp: '23°C', desc: '陶波/舒適'},
                ],

                // Souvenirs
                souvenirs: [
                    {name: 'Whittaker\'s 巧克力', desc: '超市必掃，推Hokey Pokey口味', icon: 'fa-candy-cane', color: '#5D4037'},
                    {name: 'Manuka 麥盧卡蜂蜜', desc: '認明UMF/MGO認證', icon: 'fa-jar', color: '#F59E0B'},
                    {name: 'Cookie Time', desc: '國民餅乾，微波加熱更好吃', icon: 'fa-cookie-bite', color: '#D97706'},
                    {name: 'Lanolin 綿羊油', desc: '保濕神物，價格親民', icon: 'fa-bottle-droplet', color: '#3B82F6'},
                    {name: '羊駝/羊毛製品', desc: '輕薄保暖，適合長輩', icon: 'fa-socks', color: '#6B7280'},
                ],

                // Extra Trips
                extraTrips: [
                    {name: 'Arrowtown 箭鎮', region: '近皇后鎮', desc: '魔戒取景地，淘金歷史古鎮', query: 'Arrowtown'},
                    {name: 'Mt. John 天文台', region: '蒂卡波', desc: '俯瞰牛奶湖的最佳制高點(下午3點關)', query: 'Mount John Observatory'},
                    {name: 'Hell\'s Gate 地獄之門', region: '羅托魯瓦', desc: '泥漿浴溫泉體驗', query: 'Hells Gate Geothermal Park'},
                    {name: 'Kaikoura Peninsula', region: '凱庫拉', desc: '海豹步道', query: 'Kaikoura Peninsula Walkway'},
                ],

                tabs: [
                    {id: 'itinerary', name: '每日行程'},
                    {id: 'guide', name: '旅遊攻略'},
                    {id: 'budget', name: '記帳本'}
                ],

                days: [
                    {
                        date: '2025-12-21',
                        title: '出發！前往紐西蘭',
                        route: 'TPE -> AKL',
                        km: '-',
                        driveTime: '-',
                        stay: '機上',
                        stayAddr: '', 
                        activities: [
                            {name: '前往桃園機場', desc: '15:00 出發前往機場。', type: 'transport', nav: false},
                            {name: '搭機', desc: '18:30 飛機起飛。', type: 'transport', nav: false}
                        ]
                    },
                    {
                        date: '2025-12-22',
                        title: '抵達基督城',
                        route: 'AKL -> CHC',
                        km: '-',
                        driveTime: '-',
                        stay: '50 Skyhawk Road',
                        stayAddr: '50 Skyhawk Road, Christchurch, New Zealand', 
                        activities: [
                            {name: '抵達奧克蘭 (AKL)', desc: '10:10 抵達。務必提領行李，轉國內線。', type: 'transport', tip: '轉機時間緊湊，請快步移動。', nav: false},
                            {name: '飛往基督城 (CHC)', desc: '12:00 AKL 起飛 -> 13:25 抵達。', type: 'transport', nav: false},
                            {name: '機場會合', desc: '領完行李去國際機場領行李處，等楊皓 14:00 抵達。', type: 'transport', nav: false},
                            {name: '取租車', desc: '一起前往租車處。確認賞鯨換車事宜。', type: 'transport', query: 'Ezi Car Rental Christchurch Airport'},
                            {name: '入住/採買', desc: '民宿對面是新世界超市/購物中心。', type: 'food', query: 'New World Spitfire Square'}
                        ]
                    },
                    {
                        date: '2025-12-23',
                        title: '蒂卡波與觀星',
                        route: '基督城 -> 蒂卡波 -> 特威澤爾',
                        km: '280km',
                        driveTime: '3.5h',
                        stay: '9 Harris Place, Twizel',
                        stayAddr: '9 Harris Place, Twizel, New Zealand',
                        activities: [
                            {name: 'Lake Tekapo', desc: '看魯冰花。', type: 'view', drive: '開車約 3 小時'},
                            {name: 'Lake Pukaki', desc: '順路看薰衣草，藍色牛奶湖。', type: 'view', drive: '開車約 30 分'},
                            {name: '約翰山天文台', desc: '考慮是否上去看景喝咖啡 (3點關門可能來不及)。', type: 'view', query: 'Mount John Observatory', drive: '開車約 40 分'},
                            {name: '入住特威澤爾', desc: '開車1小時入住。夜觀星星。', type: 'stay', query: '9 Harris Place, Twizel, New Zealand', drive: '開車約 45 分'}
                        ]
                    },
                    {
                        date: '2025-12-24',
                        title: '瓦納卡聖誕夜',
                        route: '特威澤爾 -> 瓦納卡',
                        km: '140km',
                        driveTime: '2h',
                        stay: '5A Kidds Way, Albert Town',
                        stayAddr: '5A Kidds Way, Albert Town, Wanaka, New Zealand',
                        activities: [
                            {name: '早點出發', desc: '因明天聖誕節很多沒開，今天先玩。', type: 'transport', nav: false},
                            {name: 'Wanaka Lavender Farm', desc: '看羊駝、小動物。', type: 'view', drive: '開車約 1.5 小時'},
                            {name: 'Puzzling World', desc: '錯視藝術與迷宮。', type: 'fun', drive: '開車約 5 分'},
                            {name: '聖誕夜晚餐', desc: '參加聖誕夜活動，湖邊看風景。', type: 'food', query: 'Wanaka Lakefront', drive: '前往市區'}
                        ]
                    },
                    {
                        date: '2025-12-25',
                        title: '瓦納卡聖誕節',
                        route: '瓦納卡一日遊',
                        km: '-',
                        driveTime: '-',
                        stay: '5A Kidds Way, Albert Town',
                        stayAddr: '5A Kidds Way, Albert Town, Wanaka, New Zealand',
                        activities: [
                            {name: 'Mount Iron Track', desc: '健行約2小時。', type: 'hike', drive: '開車約 5 分'},
                            {name: 'Rippon Vineyard', desc: '免費品酒，拍照葡萄園 (17:00關)。', type: 'view', drive: '開車約 10 分'},
                            {name: '自由活動', desc: '可考慮滑翔翼。社區有糕點薯條店。', type: 'fun', nav: false}
                        ]
                    },
                    {
                        date: '2025-12-26',
                        title: '水果鎮與螢火蟲',
                        route: '瓦納卡 -> 蒂阿瑙',
                        km: '260km',
                        driveTime: '4h',
                        stay: '6 McKerrow Street, Te Anau',
                        stayAddr: '6 McKerrow Street, Te Anau, New Zealand',
                        activities: [
                            {name: '出發', desc: '09:00 離開，早起出發。', type: 'transport', nav: false},
                            {name: 'Cromwell 水果', desc: 'Cheeki Cherries 摘櫻桃、Jones Family 買水果(13:00需離開)。', type: 'food', query: 'Jones Family Fruit Stall', drive: '開車約 45 分'},
                            {name: 'RealNZ 螢火蟲洞', desc: '報到地址: 85 Lakefront Drive。17:20 抵達驗票。', type: 'view', query: 'RealNZ Te Anau Visitor Centre', drive: '開車約 3.5 小時'},
                            {name: '入住蒂阿瑙', desc: '住湖及餐廳附近。', type: 'stay', query: '6 McKerrow Street, Te Anau, New Zealand', drive: '開車約 2 分'}
                        ]
                    },
                    {
                        date: '2025-12-27',
                        title: '米佛峽灣一日遊',
                        route: '蒂阿瑙 -> 峽灣 -> 但尼丁',
                        km: '400km',
                        driveTime: '8h+',
                        stay: '2 Jenkins St, Dunedin',
                        stayAddr: '2 Jenkins Street, Dunedin, New Zealand',
                        activities: [
                            {name: '前往峽灣', desc: '07:30 出發。導航至遊客中心。', type: 'transport', query: 'Milford Sound Visitor Terminal'},
                            {name: 'Eglinton Valley', desc: '車邊拍照五分鐘。', type: 'view', query: 'Eglinton Valley', drive: '開車約 45 分'},
                            {name: 'Mirror Lakes', desc: '湖面倒映山景停留十分鐘。', type: 'view', query: 'Mirror Lakes Walk', drive: '開車約 5 分'},
                            {name: '峽灣遊船', desc: '11:00 船班 (10:40 報到)。遊玩約2小時。', type: 'view', query: 'Milford Sound Visitor Terminal', drive: '開車約 1 小時'},
                            {name: '回程休息: Knobs Flat', desc: '有洗手間、咖啡車。', type: 'transport', query: 'Knobs Flat', drive: '回程路途'},
                            {name: 'Te Anau 加油', desc: '經過蒂阿瑙加油。', type: 'transport', query: 'Te Anau', drive: '開車約 1 小時'},
                            {name: 'Lumsden', desc: '咖啡休息點。', type: 'food', query: 'Lumsden'},
                            {name: 'Gore', desc: '中途休息伸展並加油。', type: 'transport', query: 'Gore', drive: '開車約 1 小時'},
                            {name: '入住但尼丁', desc: '行李需人工搬三層樓。', type: 'stay', query: '2 Jenkins Street, Dunedin, New Zealand', drive: '開車約 2 小時'}
                        ]
                    },
                    {
                        date: '2025-12-28',
                        title: '但尼丁與企鵝',
                        route: '但尼丁 -> 奧瑪魯',
                        km: '120km',
                        driveTime: '1.5h',
                        stay: '49 Arun Street, Oamaru',
                        stayAddr: '49 Arun Street, Oamaru, New Zealand',
                        activities: [
                            {name: '但尼丁火車站', desc: '參觀復古車站。', type: 'view', query: 'Dunedin Railway Station', drive: '開車約 10 分'},
                            {name: '鮑德溫街', desc: '世界最斜街道。', type: 'view', query: 'Baldwin Street', drive: '開車約 10 分'},
                            {name: 'Tunnel Beach', desc: '走到盡頭停車場，健行來回1小時。', type: 'hike', query: 'Tunnel Beach Track', drive: '開車約 25 分'},
                            {name: '摩拉基圓石', desc: '經過龍珠石。', type: 'view', query: 'Moeraki Boulders Beach', drive: '開車約 1 小時'},
                            {name: '奧瑪魯老街', desc: '維多利亞風情(Heritage Precinct)。', type: 'view', query: 'Oamaru\'s Heritage Precinct', drive: '開車約 40 分'},
                            {name: '企鵝歸巢', desc: '20:04 集合。South Hill。', type: 'view', query: '17 Waterfront Road, South Hill, Oamaru 9400', drive: '開車約 3 分'},
                            {name: '回程', desc: '看完企鵝回民宿休息。', type: 'transport', query: '49 Arun Street, Oamaru, New Zealand', drive: '開車約 5 分'}
                        ]
                    },
                    {
                        date: '2025-12-29',
                        title: '返回基督城',
                        route: '奧瑪魯 -> 基督城',
                        km: '250km',
                        driveTime: '3h',
                        stay: '5/54 Stewart St, CHC',
                        stayAddr: '54 Stewart Street, Christchurch, New Zealand',
                        activities: [
                            {name: 'Caroline Bay', desc: '看海豹(看運氣)、玫瑰園。', type: 'view', query: 'Caroline Bay, Timaru 7910', drive: '開車約 1 小時'},
                            {name: '入住基督城', desc: '連住三天。', type: 'stay', query: '54 Stewart Street, Christchurch, New Zealand', drive: '開車約 2 小時'}
                        ]
                    },
                    {
                        date: '2025-12-30',
                        title: '凱庫拉賞鯨',
                        route: '基督城 <-> 凱庫拉',
                        km: '360km(來回)',
                        driveTime: '5h',
                        stay: '5/54 Stewart St, CHC',
                        stayAddr: '54 Stewart Street, Christchurch, New Zealand',
                        activities: [
                            {name: '出發', desc: '07:40 出發。開2.5小時。', type: 'transport', nav: false},
                            {name: '賞鯨報到', desc: '10:45 前到達。Whaleway Station Road。', type: 'fun', query: 'Whaleway Station Road, Kaikōura 7340', drive: '開車約 2.5 小時'},
                            {name: '午餐', desc: 'Café Encounter 或 Seafood BBQ。', type: 'food', query: '96 Esplanade, Kaikōura 7300', drive: '開車約 5 分'},
                            {name: '看海豹', desc: 'Kaikoura Peninsula Walkway。', type: 'view', query: 'Kaikoura Peninsula Walkway, Kaikoura Peninsula, Kaikoura 7300', drive: '開車約 10 分'},
                            {name: '回程', desc: '回民宿及還車。', type: 'transport', query: '54 Stewart Street, Christchurch', drive: '開車約 2.5 小時'}
                        ]
                    },
                    {
                        date: '2025-12-31',
                        title: '基督城跨年',
                        route: '基督城自由行',
                        km: '-',
                        driveTime: '-',
                        stay: '5/54 Stewart St, CHC',
                        stayAddr: '54 Stewart Street, Christchurch, New Zealand',
                        activities: [
                            {name: '市區漫遊', desc: '植物園、雅芳河撐船、美術館、市集。', type: 'view', nav: false},
                            {name: '跨年音樂會', desc: 'North Hagley Park。位子不擠但會冷。', type: 'fun', query: '14 Riccarton Avenue, Christchurch Central City, Christchurch 8011'},
                            {name: '回程', desc: '跨年結束回民宿。', type: 'transport', query: '54 Stewart Street, Christchurch', drive: '開車約 10 分'}
                        ]
                    },
                    {
                        date: '2026-01-01',
                        title: '飛往北島',
                        route: 'CHC -> WLG -> Ohakune',
                        km: '290km',
                        driveTime: '4h',
                        stay: 'Ohakune Carrot Park',
                        stayAddr: 'Ohakune Carrot Adventure Park, New Zealand',
                        activities: [
                            {name: '前往機場', desc: '10:00 退房預約車子去機場。', type: 'transport', query: 'Christchurch Airport'},
                            {name: '飛往威靈頓', desc: '12:15 飛 -> 13:30 到。', type: 'transport', nav: false},
                            {name: '租車北上', desc: '14:30 租完車。確認延後還車計價。', type: 'transport', query: 'Wellington Airport Car Rental'},
                            {name: '前往 Ohakune', desc: '開4小時(中途 Wild Bean Café 休息)。', type: 'transport', nav: false, drive: '開車約 4 小時'},
                            {name: '入住', desc: '胡蘿蔔公園後面。無冷氣有風扇。', type: 'stay', query: 'Ohakune Carrot Adventure Park'}
                        ]
                    },
                    {
                        date: '2026-01-02',
                        title: '火山與陶波',
                        route: 'Ohakune -> 陶波',
                        km: '150km',
                        driveTime: '2h',
                        stay: '10 Wiremu St, Tūrangi',
                        stayAddr: '10 Wiremu Street, Turangi, New Zealand',
                        activities: [
                            {name: 'Ruapehu 火山', desc: 'Iwikau Village 看全貌。Meads Wall 步道(15分)。', type: 'view', query: 'Iwikau Village', drive: '開車約 45 分'},
                            {name: '瀑布步道', desc: 'Tawhai Falls (20分) 或 Taranaki Falls (2-3小時)。', type: 'hike', query: 'Taranaki Falls Track'},
                            {name: '前往陶波', desc: '下午開 1.5 小時。', type: 'transport', nav: false, drive: '開車約 1.5 小時'},
                            {name: 'Huka Prawn Park', desc: '吃蝦、釣蝦、玩水槍(帶衣物)。', type: 'fun', query: 'Huka Prawn Park'}
                        ]
                    },
                    {
                        date: '2026-01-03',
                        title: '羅托魯瓦探險',
                        route: '陶波 -> 羅托魯瓦',
                        km: '80km',
                        driveTime: '1h',
                        stay: '4 Westbourne Ave, Rotorua',
                        stayAddr: '4 Westbourne Avenue, Rotorua, New Zealand',
                        activities: [
                            {name: '前往羅托魯瓦', desc: '經 Wildwood Farm 花卉農場。', type: 'transport', query: 'Wildwood Farm', drive: '開車約 1 小時'},
                            {name: 'Skyline', desc: '空中纜車+5圈滑板車 (約3小時)。', type: 'fun', query: 'Skyline Rotorua'},
                            {name: '紅木森林', desc: 'Redwoods Treewalk 夜間點燈步道。', type: 'view', query: 'Redwoods Treewalk'}
                        ]
                    },
                    {
                        date: '2026-01-04',
                        title: '樹冠與地熱',
                        route: '羅托魯瓦一日遊',
                        km: '-',
                        driveTime: '-',
                        stay: '4 Westbourne Ave, Rotorua',
                        stayAddr: '4 Westbourne Avenue, Rotorua, New Zealand',
                        activities: [
                            {name: '樹冠層滑索', desc: '09:15 Canopy Tours (3.5小時)。', type: 'fun', query: 'Rotorua Canopy Tours'},
                            {name: '地獄之門', desc: '午餐後去地熱區及泥浴體驗。', type: 'view', query: 'Hells Gate Geothermal Park'},
                            {name: 'Heritage 農場', desc: '16:00 前去與動物互動。', type: 'fun', query: 'Agrodome'}
                        ]
                    },
                    {
                        date: '2026-01-05',
                        title: '間歇泉與滾球',
                        route: '羅托魯瓦一日遊',
                        km: '-',
                        driveTime: '-',
                        stay: '4 Westbourne Ave, Rotorua',
                        stayAddr: '4 Westbourne Avenue, Rotorua, New Zealand',
                        activities: [
                            {name: 'Lady Knox 間歇泉', desc: '10:15 噴發，09:30 前卡位。', type: 'view', query: 'Lady Knox Geyser'},
                            {name: 'Wai-O-Tapu', desc: '走彩色地熱區 1.5-2 小時。', type: 'view', query: 'Wai-O-Tapu Thermal Wonderland'},
                            {name: 'ZORB 水球', desc: '下午玩滾球。帶GoPro、浴巾換洗衣物。', type: 'fun', query: 'ZORB Rotorua'}
                        ]
                    },
                    {
                        date: '2026-01-06',
                        title: '前往奧克蘭',
                        route: '羅托魯瓦 -> 奧克蘭',
                        km: '230km',
                        driveTime: '3h',
                        stay: '64 Federal St, Auckland',
                        stayAddr: '64 Federal Street, Auckland, New Zealand',
                        activities: [
                            {name: '前往奧克蘭', desc: '經 Hamilton 向日葵農場。', type: 'transport', query: 'Auckland', drive: '開車約 3 小時'},
                            {name: '還車', desc: '14:30 左右還車。入住。', type: 'transport', nav: false}
                        ]
                    },
                    {
                        date: '2026-01-07',
                        title: '奧克蘭市區',
                        route: '奧克蘭自由行',
                        km: '-',
                        driveTime: '-',
                        stay: '64 Federal St, Auckland',
                        stayAddr: '64 Federal Street, Auckland, New Zealand',
                        activities: [
                            {name: '市區觀光', desc: '皇后街、天空塔、Britomart。', type: 'shop', query: 'Queen Street, Auckland'},
                            {name: '海港橋', desc: '考慮攀登或蹦極。', type: 'fun', query: 'Auckland Harbour Bridge'},
                            {name: '預約車子', desc: '記得預約明天去機場的車。', type: 'transport', nav: false}
                        ]
                    },
                    {
                        date: '2026-01-08',
                        title: '回家囉',
                        route: 'AKL -> TPE',
                        km: '-',
                        driveTime: '-',
                        stay: '-',
                        activities: [
                            {name: '前往機場', desc: '搭機返台。', type: 'transport', query: 'Auckland Airport'},
                            {name: '起飛', desc: '10:45 飛機。', type: 'transport', nav: false}
                        ]
                    }
                ],

                init() {
                    this.updateCurrentDay();
                    if (isNaN(this.currentDayNum) || this.currentDayNum < 1) this.currentDayNum = 1;
                    this.$watch('ledger', (val) => {
                        localStorage.setItem('nz_ledger', JSON.stringify(val));
                    });
                },

                updateCurrentDay() {
                    const startDate = new Date('2025-12-21');
                    const today = new Date();
                    if (isNaN(today.getTime())) return;
                    const diffTime = today - startDate;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                    this.currentDayNum = diffDays;
                },

                // CRUD Logic
                addLedgerItem() {
                    if(!this.newEntryName || !this.newEntryCost) return;
                    this.ledger.push({
                        id: Date.now(),
                        name: this.newEntryName,
                        cost: parseInt(this.newEntryCost)
                    });
                    this.newEntryName = '';
                    this.newEntryCost = '';
                },

                removeLedgerItem(id) {
                    this.ledger = this.ledger.filter(item => item.id !== id);
                },

                getTotalCost() {
                    return this.ledger.reduce((sum, item) => sum + (parseInt(item.cost) || 0), 0).toLocaleString();
                },

                toggleDay(index) {
                    if (this.openDay === index) {
                        this.openDay = -1;
                    } else {
                        this.openDay = index;
                        // 解決畫面跳動：平滑捲動到卡片頂部
                        setTimeout(() => {
                            const element = document.getElementById('day-' + index);
                            if (element) {
                                // 減去 header 高度 (約 100px) 加上一點緩衝
                                const y = element.getBoundingClientRect().top + window.scrollY - 110; 
                                window.scrollTo({top: y, behavior: 'smooth'});
                            }
                        }, 100);
                    }
                },

                formatDate(dateStr) {
                    const date = new Date(dateStr);
                    return date.getDate();
                },
                
                formatMonth(dateStr) {
                    const date = new Date(dateStr);
                    return date.toLocaleString('default', { month: 'short' });
                },
                
                isPast(dateStr) {
                    const date = new Date(dateStr);
                    const today = new Date('2025-12-22');
                    return date < today;
                },

                getMapLink(query) {
                    if (!query) return '#';
                    // Reverted back to search mode for previewing from Taiwan
                    return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
                },
                
                getDotColor(type) {
                    const map = {
                        transport: 'dot-gray',
                        food: 'dot-orange',
                        stay: 'dot-indigo',
                        view: 'dot-green',
                        fun: 'dot-red',
                        shop: 'dot-purple',
                        star: 'dot-blue',
                        hike: 'dot-emerald'
                    };
                    return map[type] || 'dot-gray';
                }
            }));
        });
    </script>

    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>

    <style>
        /* === RESET & VARIABLES === */
        :root {
            --primary: #5D7E68;
            --secondary: #D4A373;
            --bg: #F9F7F2;
            --text-main: #2C3E50;
            --text-light: #64748B;
            --card-bg: rgba(255, 255, 255, 0.95);
            --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
            padding-bottom: calc(90px + var(--safe-bottom));
            min-height: 100vh;
            min-height: 100dvh;
        }

        [x-cloak] { display: none !important; }

        /* === TYPOGRAPHY === */
        h1, h2, h3, h4 { margin: 0; font-weight: 700; }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        /* === LAYOUT UTILS === */
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .flex-1 { flex: 1; }
        .shrink-0 { flex-shrink: 0; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .hidden { display: none; }
        .block { display: block; }
        .w-full { width: 100%; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mr-2 { margin-right: 0.5rem; }
        .ml-2 { margin-left: 0.5rem; }
        .p-4 { padding: 1rem; }
        .p-5 { padding: 1.25rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        
        /* === COMPONENTS === */
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(249, 247, 242, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            z-index: 50;
            padding-top: calc(10px + var(--safe-top));
            padding-bottom: 10px;
            padding-left: 20px;
            padding-right: 20px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            max-width: 600px;
            margin: 0 auto;
        }

        .subtitle { font-size: 10px; letter-spacing: 2px; color: var(--primary); text-transform: uppercase; font-weight: 700; }
        .title { font-size: 24px; color: #333; }
        .day-counter { font-size: 24px; color: var(--secondary); font-weight: 700; }

        /* Main Container */
        main {
            margin-top: calc(90px + var(--safe-top));
            padding: 0 16px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Tabs */
        .tabs-container {
            position: sticky;
            top: calc(75px + var(--safe-top));
            z-index: 40;
            background: linear-gradient(to bottom, var(--bg) 80%, transparent);
            padding: 10px 0;
            margin: 0 -16px 16px -16px; 
            padding-left: 16px; 
            display: flex;
            gap: 10px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tabs-container::-webkit-scrollbar { display: none; }

        .tab-btn {
            background: #fff;
            border: 1px solid rgba(0,0,0,0.05);
            padding: 8px 16px;
            border-radius: 999px;
            font-size: 14px;
            font-weight: 700;
            color: #999;
            white-space: nowrap;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }

        .tab-btn.active {
            background: var(--primary);
            color: #fff;
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(93, 126, 104, 0.3);
        }

        /* Card Style */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            margin-bottom: 16px;
            overflow: hidden;
            transition: transform 0.2s;
        }
        
        .card.expanded {
            box-shadow: 0 10px 30px rgba(0,0,0,0.06);
            border-color: var(--primary);
        }

        .card.past {
            opacity: 0.7;
            filter: grayscale(0.5);
        }

        /* Date Badge */
        .date-badge {
            width: 50px;
            height: 50px;
            background: #f3f4f6;
            border-radius: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .date-badge.active { background: var(--primary); color: #fff; }
        .date-badge span:first-child { font-size: 10px; text-transform: uppercase; font-weight: 700; }
        .date-badge span:last-child { font-size: 20px; font-weight: 700; line-height: 1; }

        /* Flight Card Special */
        .flight-card {
            border-left: 6px solid var(--primary); 
            border-left-color: #6B8E9B; 
        }
        
        .flight-line {
            height: 2px;
            background: #e5e7eb;
            position: relative;
            margin: 0 10px;
            flex: 1;
        }
        .flight-line::before, .flight-line::after {
            content: ''; position: absolute; top: -3px; width: 8px; height: 8px; border-radius: 50%;
        }
        .flight-line::before { left: 0; background: #ccc; }
        .flight-line::after { right: 0; background: #6B8E9B; }
        .plane-icon-center { position: absolute; top: -8px; left: 50%; transform: translateX(-50%); color: #6B8E9B; font-size: 12px;}

        /* Timeline */
        .timeline-container {
            position: relative;
            padding-left: 16px;
            margin-left: 8px;
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 24px;
        }
        
        .timeline-line {
            position: absolute;
            left: 7px;
            top: 15px;
            bottom: -15px;
            width: 2px;
            background: #e5e7eb;
        }
        .timeline-item:last-child .timeline-line { display: none; }

        .timeline-dot {
            position: absolute;
            left: -2px;
            top: 4px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 3px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 10;
        }

        /* Dot Colors */
        .dot-gray { background: #9ca3af; }
        .dot-orange { background: #fb923c; }
        .dot-indigo { background: #6366f1; }
        .dot-green { background: #5D7E68; }
        .dot-red { background: #ef4444; }
        .dot-purple { background: #c084fc; }
        .dot-blue { background: #1e40af; }
        .dot-emerald { background: #059669; }

        .activity-content {
            padding-left: 24px;
            display: flex;
            justify-content: space-between;
            align-items: start;
        }

        /* Map Button */
        .map-btn {
            width: 32px;
            height: 32px;
            background: #f9fafb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            text-decoration: none;
            flex-shrink: 0;
            margin-left: 10px;
            transition: all 0.2s;
        }
        .map-btn:active { background: var(--primary); color: #fff; }

        /* Tip Box */
        .tip-box {
            display: inline-flex;
            align-items: flex-start;
            background: #fffbeb;
            border: 1px solid #fcd34d;
            color: #92400e;
            font-size: 11px;
            padding: 6px 10px;
            border-radius: 8px;
            margin-top: 8px;
            line-height: 1.4;
        }
        
        /* Drive Time Box */
        .drive-box {
            font-size: 10px;
            color: #666;
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 4px;
            display: inline-block;
        }

        /* Bottom Nav (Wider) */
        .bottom-nav {
            position: fixed;
            bottom: calc(20px + var(--safe-bottom));
            left: 50%;
            transform: translateX(-50%);
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 12px 0;
            width: 90%;
            max-width: 450px;
            border-radius: 99px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
            z-index: 100;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .nav-btn {
            background: none;
            border: none;
            color: #94a3b8;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 11px;
            font-weight: 500;
            width: 60px;
        }
        
        .nav-btn i { font-size: 20px; margin-bottom: 4px; transition: transform 0.2s; }
        .nav-btn.active { color: var(--secondary); font-weight: 700; }
        .nav-btn.active i { transform: translateY(-2px); }

        /* Budget Table & Form */
        .budget-table { width: 100%; border-collapse: collapse; }
        .budget-table th { text-align: left; padding: 12px 16px; background: #f9fafb; font-size: 12px; color: #6b7280; text-transform: uppercase; }
        .budget-table td { padding: 14px 16px; border-bottom: 1px solid #f3f4f6; font-size: 14px; vertical-align: middle; }
        .budget-table td:nth-child(2) { text-align: right; font-weight: 700; font-family: monospace; }
        .budget-table td:last-child { width: 40px; text-align: center; }
        
        .delete-btn { color: #ef4444; background: none; border: none; font-size: 14px; padding: 8px; cursor: pointer; opacity: 0.5; }
        .delete-btn:active { opacity: 1; }
        
        .add-form { background: #f3f4f6; padding: 16px; display: flex; gap: 10px; align-items: center; border-bottom: 1px solid #e5e7eb; }
        .form-input { flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #d1d5db; font-size: 14px; outline: none; }
        .form-input:focus { border-color: var(--primary); }
        .add-btn { background: var(--primary); color: white; border: none; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* Weather Forecast UI */
        .forecast-container { display: flex; flex-direction: column; gap: 12px; }
        .forecast-row { display: flex; align-items: center; background: rgba(255,255,255,0.7); padding: 10px 15px; border-radius: 12px; justify-content: space-between; }
        .forecast-date { font-weight: bold; font-size: 14px; color: #333; width: 40px; }
        .forecast-icon { font-size: 18px; color: #fbbf24; width: 30px; text-align: center; }
        .forecast-temp { font-weight: bold; font-size: 16px; color: #333; width: 50px; text-align: right; }
        .forecast-desc { font-size: 12px; color: #666; text-align: right; flex: 1; }
        .island-title { font-size: 12px; font-weight: 700; color: #666; margin: 10px 0 5px 5px; text-transform: uppercase; letter-spacing: 1px; }

        /* Souvenir List */
        .souvenir-item { display: flex; align-items: center; background: white; padding: 12px; border-radius: 12px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .souvenir-icon { width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; color: white; margin-right: 12px; flex-shrink: 0; }
        .souvenir-info h4 { font-size: 14px; margin-bottom: 2px; }
        .souvenir-info p { font-size: 11px; color: #666; margin: 0; }

        /* Extra Trip Card */
        .trip-card { background: white; border-radius: 16px; padding: 15px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.03); display: flex; justify-content: space-between; align-items: center; }
        .trip-info h4 { font-size: 15px; color: #333; margin-bottom: 4px; }
        .trip-info .tag { font-size: 10px; background: #e0f2f1; color: #0f766e; padding: 2px 6px; border-radius: 4px; display: inline-block; margin-bottom: 4px; }
        .trip-info p { font-size: 12px; color: #666; margin: 0; }
        .nav-round-btn { background: #f3f4f6; color: var(--primary); width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; }

    </style>
</head>
<body x-data="itineraryApp" x-cloak>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div>
                <div class="subtitle">New Zealand 2025-26</div>
                <h1 class="title font-serif">紐西蘭・夏日漫遊</h1>
            </div>
            <div class="text-right">
                <div style="font-size: 10px; color: #999; text-transform: uppercase;">Day</div>
                <div class="day-counter font-serif" x-text="currentDayNum"></div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>

        <!-- Tab Navigation -->
        <div class="tabs-container">
            <template x-for="tab in tabs">
                <button 
                    @click="activeTab = tab.id; window.scrollTo({top: 0, behavior: 'smooth'})"
                    class="tab-btn"
                    :class="activeTab === tab.id ? 'active' : ''"
                    x-text="tab.name">
                </button>
            </template>
        </div>

        <!-- 1. ITINERARY VIEW -->
        <div x-show="activeTab === 'itinerary'" x-transition.opacity>
            
            <!-- Flight Card -->
            <div class="card flight-card p-5">
                <div class="flex justify-between items-center mb-4">
                    <span style="background:#6B8E9B; color:white; font-size:10px; font-weight:bold; padding:2px 6px; border-radius:4px;">FLIGHT</span>
                    <span style="font-size:12px; color:#999; font-family:monospace;">TRIP START</span>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="text-center">
                        <div style="font-size:24px; font-weight:700;">TPE</div>
                        <div style="font-size:12px; color:#666;">台北</div>
                    </div>
                    
                    <div class="flight-line">
                        <i class="fa-solid fa-plane plane-icon-center"></i>
                    </div>
                    
                    <div class="text-center">
                        <div style="font-size:24px; font-weight:700;">AKL</div>
                        <div style="font-size:12px; color:#666;">奧克蘭</div>
                    </div>
                </div>

                <div class="tip-box" style="width:100%; border-color:#fecaca; background:#fef2f2; color:#b91c1c; margin-top:16px;">
                    <i class="fa-solid fa-triangle-exclamation" style="margin-right:6px; margin-top:2px;"></i> 
                    <div>
                        <span style="font-weight:bold; display:block;">轉機重要提醒</span>
                        在奧克蘭必須 <span style="text-decoration:underline;">提領行李</span> 並重新check-in國內線！
                    </div>
                </div>
            </div>

            <!-- Days List -->
            <template x-for="(day, index) in days" :key="index">
                <div :id="'day-' + index" class="card" :class="{'expanded': openDay === index, 'past': isPast(day.date) && openDay !== index}">
                    
                    <!-- Card Header -->
                    <div @click="toggleDay(index)" class="p-5 flex items-center justify-between" style="cursor: pointer;">
                        <div class="flex items-center" style="gap: 16px;">
                            <div class="date-badge" :class="{'active': openDay === index}">
                                <span x-text="formatMonth(day.date)"></span>
                                <span x-text="formatDate(day.date)"></span>
                            </div>
                            <div style="min-width: 0; flex: 1;"> <!-- Fix for text overflow -->
                                <h3 style="font-size:16px; margin-bottom:4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" x-text="day.title"></h3>
                                <div style="font-size:12px; color:#666; display:flex; items-align:center;">
                                    <span style="width:6px; height:6px; background:var(--secondary); border-radius:50%; margin-right:6px; margin-top:5px;"></span>
                                    <span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" x-text="day.route"></span>
                                </div>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-down" style="color:#ccc; transition:0.3s;" :style="openDay === index ? 'transform:rotate(180deg); color:var(--primary)' : ''"></i>
                    </div>

                    <!-- Card Body -->
                    <div x-show="openDay === index" x-collapse style="border-top:1px solid #f3f4f6;">
                        <!-- Transport Info -->
                        <div class="px-4 py-2" style="background:#f9fafb; display:flex; gap:20px; font-size:12px; color:#666; font-weight:500;">
                            <span x-show="day.km !== '-'"><i class="fa-solid fa-road mr-2"></i> <span x-text="day.km"></span></span>
                            <span x-show="day.driveTime !== '-'"><i class="fa-regular fa-clock mr-2"></i> <span x-text="day.driveTime"></span></span>
                        </div>

                        <!-- Timeline -->
                        <div class="p-5">
                            <div class="timeline-container">
                                <template x-for="(item, idx) in day.activities">
                                    <div class="timeline-item">
                                        <div class="timeline-line"></div>
                                        <div class="timeline-dot" :class="getDotColor(item.type)"></div>
                                        
                                        <div class="activity-content">
                                            <div style="flex:1; min-width:0;">
                                                <!-- Drive Time Badge (Displayed above activity) -->
                                                <div x-show="item.drive" class="drive-box" style="margin-bottom: 6px;">
                                                    <i class="fa-solid fa-car-side" style="margin-right: 4px;"></i>
                                                    <span x-text="item.drive"></span>
                                                </div>

                                                <div style="font-weight:700; font-size:14px; margin-bottom:4px;" x-text="item.name"></div>
                                                <div style="font-size:12px; color:#666; line-height:1.5;" x-text="item.desc"></div>
                                                
                                                <div x-show="item.tip" class="tip-box">
                                                    <i class="fa-solid fa-lightbulb" style="margin-right:6px; color:#f59e0b;"></i>
                                                    <span x-text="item.tip"></span>
                                                </div>
                                            </div>
                                            <!-- Conditional Nav Button -->
                                            <a x-show="item.nav !== false" :href="getMapLink(item.query || item.name)" target="_blank" class="map-btn">
                                                <i class="fa-solid fa-location-arrow" style="font-size:12px;"></i>
                                            </a>
                                        </div>
                                    </div>
                                </template>
                            </div>

                            <!-- Stay Info -->
                            <div x-show="day.stay && day.stay !== '-'" style="margin-top:10px; padding-top:16px; border-top:1px solid #f3f4f6;">
                                <div style="display:flex; background:#eef2ff; border-radius:12px; padding:12px; border:1px solid #e0e7ff;">
                                    <div style="width:32px; height:32px; background:#e0e7ff; color:#6366f1; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:12px;">
                                        <i class="fa-solid fa-bed" style="font-size:12px;"></i>
                                    </div>
                                    <div style="flex:1;">
                                        <div style="font-size:10px; font-weight:700; color:#818cf8; text-transform:uppercase;">Tonight's Stay</div>
                                        <div style="font-size:14px; font-weight:700; color:#333;" x-text="day.stay"></div>
                                        <div x-show="day.stayAddr" style="font-size:12px; color:#666; margin-top:4px;" x-text="day.stayAddr"></div>
                                        <a x-show="day.stayAddr" :href="getMapLink(day.stayAddr)" target="_blank" style="display:inline-block; margin-top:8px; font-size:12px; font-weight:700; color:#6366f1; text-decoration:none;">導航去住宿 &rarr;</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
            <div style="height: 40px;"></div>
        </div>

        <!-- 2. GUIDE VIEW -->
        <div x-show="activeTab === 'guide'" x-transition.opacity>
            <!-- ... existing guide content ... -->
            <!-- Weather Forecast Widget -->
            <div class="card p-5" style="background: linear-gradient(180deg, #e0f7fa 0%, #ffffff 100%); border:none;">
                <h3 class="font-serif" style="margin-bottom:12px; color:#0e7490;">天氣預報</h3>
                
                <!-- South Island -->
                <div class="island-title">南島 (基督城/皇后鎮)</div>
                <div class="forecast-container">
                    <template x-for="w in weatherSouth">
                        <div class="forecast-row">
                            <div class="forecast-date" x-text="w.day"></div>
                            <div class="forecast-icon"><i class="fa-solid" :class="w.icon"></i></div>
                            <div class="forecast-temp" x-text="w.temp"></div>
                            <div class="forecast-desc" x-text="w.desc"></div>
                        </div>
                    </template>
                </div>

                <!-- North Island -->
                <div class="island-title" style="margin-top:20px;">北島 (奧克蘭/羅托魯瓦)</div>
                <div class="forecast-container">
                    <template x-for="w in weatherNorth">
                        <div class="forecast-row">
                            <div class="forecast-date" x-text="w.day"></div>
                            <div class="forecast-icon"><i class="fa-solid" :class="w.icon"></i></div>
                            <div class="forecast-temp" x-text="w.temp"></div>
                            <div class="forecast-desc" x-text="w.desc"></div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- Souvenirs -->
            <h3 style="margin: 24px 0 12px 4px; font-size: 18px;">必買伴手禮清單</h3>
            <div style="margin-bottom: 24px;">
                <template x-for="item in souvenirs">
                    <div class="souvenir-item">
                        <div class="souvenir-icon" :style="`background: ${item.color}`">
                            <i class="fa-solid" :class="item.icon"></i>
                        </div>
                        <div class="souvenir-info">
                            <h4 x-text="item.name"></h4>
                            <p x-text="item.desc"></p>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Extra Trips -->
            <h3 style="margin: 0 0 12px 4px; font-size: 18px;">沿途順遊推薦</h3>
            <div style="margin-bottom: 24px;">
                <template x-for="trip in extraTrips">
                    <div class="trip-card">
                        <div class="trip-info">
                            <span class="tag" x-text="trip.region"></span>
                            <h4 x-text="trip.name"></h4>
                            <p x-text="trip.desc"></p>
                        </div>
                        <a :href="getMapLink(trip.query)" target="_blank" class="nav-round-btn">
                            <i class="fa-solid fa-location-dot"></i>
                        </a>
                    </div>
                </template>
            </div>

            <div class="card p-5" style="border-left:4px solid #ef4444; background:#fef2f2;">
                <h3 style="color:#b91c1c; font-size:16px; margin-bottom:12px;"><i class="fa-solid fa-car-side mr-2"></i> 自駕生死守則</h3>
                <ul style="padding-left:20px; font-size:14px; color:#7f1d1d; line-height:1.6;">
                    <li><strong>右駕靠左！</strong>雨刷方向燈相反。</li>
                    <li>圓環 (Roundabout) 禮讓右方來車。</li>
                    <li>單線橋樑看箭頭優先權。</li>
                </ul>
            </div>
            <div style="height: 40px;"></div>
        </div>

        <!-- 3. BUDGET (LEDGER) VIEW -->
        <div x-show="activeTab === 'budget'" x-transition.opacity>
            <!-- ... existing budget content ... -->
            <div class="card" style="overflow:hidden;">
                <!-- Total Header -->
                <div style="background:#2C3E50; color:white; padding:24px; position:relative;">
                    <h3 class="font-serif">旅費總支出</h3>
                    <div style="font-size:32px; font-weight:700; margin-top:8px;" x-text="'$' + getTotalCost()"></div>
                    <div style="font-size:12px; opacity:0.7;">TWD (自動加總)</div>
                    <div style="position:absolute; right:20px; top:24px; opacity:0.2; font-size:40px;">
                        <i class="fa-solid fa-wallet"></i>
                    </div>
                </div>

                <!-- Add New Entry Form -->
                <div class="add-form">
                    <input type="text" x-model="newEntryName" placeholder="項目名稱" class="form-input" style="flex:2;">
                    <input type="number" x-model="newEntryCost" placeholder="$" class="form-input" style="flex:1;">
                    <button @click="addLedgerItem()" class="add-btn">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>
                
                <!-- Ledger List -->
                <table class="budget-table">
                    <tbody>
                        <template x-for="item in ledger" :key="item.id">
                            <tr>
                                <td x-text="item.name" style="color:#4b5563;"></td>
                                <td x-text="item.cost"></td>
                                <td>
                                    <button @click="removeLedgerItem(item.id)" class="delete-btn">
                                        <i class="fa-regular fa-trash-can"></i>
                                    </button>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
                <div style="background:#f9fafb; padding:15px; text-align:center; font-size:12px; color:#9ca3af; line-height:1.4;">
                    資料自動儲存於此手機<br>
                    <span style="font-size:10px;">* 請勿清除瀏覽器快取以免資料遺失</span>
                </div>
            </div>
            <div style="height: 40px;"></div>
        </div>

    </main>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
        <button @click="activeTab = 'itinerary'; window.scrollTo({top: 0, behavior: 'smooth'})" 
                class="nav-btn" :class="activeTab === 'itinerary' ? 'active' : ''">
            <i class="fa-solid fa-map"></i> 行程
        </button>
        <button @click="activeTab = 'guide'; window.scrollTo({top: 0, behavior: 'smooth'})" 
                class="nav-btn" :class="activeTab === 'guide' ? 'active' : ''">
            <i class="fa-solid fa-compass"></i> 攻略
        </button>
        <button @click="activeTab = 'budget'; window.scrollTo({top: 0, behavior: 'smooth'})" 
                class="nav-btn" :class="activeTab === 'budget' ? 'active' : ''">
            <i class="fa-solid fa-receipt"></i> 記帳
        </button>
    </nav>

</body>
</html>
