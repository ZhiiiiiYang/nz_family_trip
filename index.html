<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    
    <!-- App Icon & Title (iOS Home Screen) -->
    <meta name="apple-mobile-web-app-title" content="NZ Family Trip">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="shortcut icon" type="image/png" href="icon.png">

    <title>紐西蘭南北島・家庭大旅行</title>
    
    <!-- FontAwesome (Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <!-- App Logic -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('itineraryApp', () => ({
                openDay: 0, 
                currentDayNum: 1,
                
                days: [
                    {
                        date: '2025-12-21',
                        title: '出發！前往紐西蘭',
                        route: 'TPE -> AKL',
                        km: '-',
                        driveTime: '-',
                        stay: '機上',
                        stayAddr: '', 
                        activities: [
                            {name: '前往桃園機場', desc: '15:00 出發前往機場。', type: 'transport', nav: false},
                            {name: '搭機', desc: '18:30 飛機起飛。', type: 'transport', nav: false}
                        ]
                    },
                    {
                        date: '2025-12-22',
                        title: '抵達基督城',
                        route: 'AKL -> CHC',
                        km: '-',
                        driveTime: '-',
                        stay: '50 Skyhawk Road',
                        stayAddr: '50 Skyhawk Road, Christchurch, New Zealand', 
                        activities: [
                            {name: '抵達奧克蘭 (AKL)', desc: '10:10 抵達。務必提領行李，轉國內線。', type: 'transport', tip: '轉機時間緊湊，請快步移動。', nav: false},
                            {name: '飛往基督城 (CHC)', desc: '12:00 AKL 起飛 -> 13:25 抵達。', type: 'transport', nav: false},
                            {name: '機場會合', desc: '領完行李去國際機場領行李處，等楊皓 14:00 抵達。', type: 'transport', nav: false},
                            {name: '取租車', desc: '一起前往租車處。確認賞鯨換車事宜。', type: 'transport', query: 'Ezi Car Rental Christchurch Airport'},
                            {name: '入住/採買', desc: '民宿對面是新世界超市/購物中心。', type: 'food', query: 'New World Spitfire Square'}
                        ]
                    },
                    {
                        date: '2025-12-23',
                        title: '蒂卡波與觀星',
                        route: '基督城 -> 蒂卡波 -> 特威澤爾',
                        km: '280km',
                        driveTime: '3.5h',
                        stay: '9 Harris Place, Twizel',
                        stayAddr: '9 Harris Place, Twizel, New Zealand',
                        activities: [
                            {name: 'Lake Tekapo', desc: '看魯冰花。', type: 'view', drive: '開車約 3 小時'},
                            {name: 'Lake Pukaki', desc: '順路看薰衣草，藍色牛奶湖。', type: 'view', drive: '開車約 30 分'},
                            {name: '約翰山天文台', desc: '考慮是否上去看景喝咖啡 (3點關門可能來不及)。', type: 'view', query: 'Mount John Observatory', drive: '開車約 40 分'},
                            {name: '入住特威澤爾', desc: '開車1小時入住。夜觀星星。', type: 'stay', query: '9 Harris Place, Twizel, New Zealand', drive: '開車約 45 分'}
                        ]
                    },
                    {
                        date: '2025-12-24',
                        title: '瓦納卡聖誕夜',
                        route: '特威澤爾 -> 瓦納卡',
                        km: '140km',
                        driveTime: '2h',
                        stay: '5A Kidds Way, Albert Town',
                        stayAddr: '5A Kidds Way, Albert Town, Wanaka, New Zealand',
                        activities: [
                            {name: '早點出發', desc: '因明天聖誕節很多沒開，今天先玩。', type: 'transport', nav: false},
                            {name: 'Wanaka Lavender Farm', desc: '看羊駝、小動物。', type: 'view', drive: '開車約 1.5 小時'},
                            {name: 'Puzzling World', desc: '錯視藝術與迷宮。', type: 'fun', drive: '開車約 5 分'},
                            {name: '聖誕夜晚餐', desc: '參加聖誕夜活動，湖邊看風景。', type: 'food', query: 'Wanaka Lakefront', drive: '前往市區'}
                        ]
                    },
                    {
                        date: '2025-12-25',
                        title: '瓦納卡聖誕節',
                        route: '瓦納卡一日遊',
                        km: '-',
                        driveTime: '-',
                        stay: '5A Kidds Way, Albert Town',
                        stayAddr: '5A Kidds Way, Albert Town, Wanaka, New Zealand',
                        activities: [
                            {name: 'Mount Iron Track', desc: '健行約2小時。', type: 'hike', drive: '開車約 5 分'},
                            {name: 'Rippon Vineyard', desc: '免費品酒，拍照葡萄園 (17:00關)。', type: 'view', drive: '開車約 10 分'},
                            {name: '自由活動', desc: '可考慮滑翔翼。社區有糕點薯條店。', type: 'fun', nav: false}
                        ]
                    },
                    {
                        date: '2025-12-26',
                        title: '水果鎮與螢火蟲',
                        route: '瓦納卡 -> 蒂阿瑙',
                        km: '260km',
                        driveTime: '4h',
                        stay: '6 McKerrow Street, Te Anau',
                        stayAddr: '6 McKerrow Street, Te Anau, New Zealand',
                        activities: [
                            {name: '出發', desc: '09:00 離開，早起出發。', type: 'transport', nav: false},
                            {name: 'Cromwell 水果', desc: 'Cheeki Cherries 摘櫻桃、Jones Family 買水果(13:00需離開)。', type: 'food', query: 'Jones Family Fruit Stall', drive: '開車約 45 分'},
                            {name: 'RealNZ 螢火蟲洞', desc: '報到地址: 85 Lakefront Drive。17:20 抵達驗票。', type: 'view', query: 'RealNZ Te Anau Visitor Centre', drive: '開車約 3.5 小時'},
                            {name: '入住蒂阿瑙', desc: '住湖及餐廳附近。', type: 'stay', query: '6 McKerrow Street, Te Anau, New Zealand', drive: '開車約 2 分'}
                        ]
                    },
                    {
                        date: '2025-12-27',
                        title: '米佛峽灣一日遊',
                        route: '蒂阿瑙 -> 峽灣 -> 但尼丁',
                        km: '400km',
                        driveTime: '8h+',
                        stay: '2 Jenkins St, Dunedin',
                        stayAddr: '2 Jenkins Street, Dunedin, New Zealand',
                        activities: [
                            {name: '前往峽灣', desc: '07:30 出發。導航至遊客中心。', type: 'transport', query: 'Milford Sound Visitor Terminal'},
                            {name: 'Eglinton Valley', desc: '車邊拍照五分鐘。', type: 'view', query: 'Eglinton Valley', drive: '開車約 45 分'},
                            {name: 'Mirror Lakes', desc: '湖面倒映山景停留十分鐘。', type: 'view', query: 'Mirror Lakes Walk', drive: '開車約 5 分'},
                            {name: '峽灣遊船', desc: '11:00 船班 (10:40 報到)。遊玩約2小時。', type: 'view', query: 'Milford Sound Visitor Terminal', drive: '開車約 1 小時'},
                            {name: '回程休息: Knobs Flat', desc: '有洗手間、咖啡車。', type: 'transport', query: 'Knobs Flat', drive: '回程路途'},
                            {name: 'Te Anau 加油', desc: '經過蒂阿瑙加油。', type: 'transport', query: 'Te Anau', drive: '開車約 1 小時'},
                            {name: 'Lumsden', desc: '咖啡休息點。', type: 'food', query: 'Lumsden'},
                            {name: 'Gore', desc: '中途休息伸展並加油。', type: 'transport', query: 'Gore', drive: '開車約 1 小時'},
                            {name: '入住但尼丁', desc: '行李需人工搬三層樓。', type: 'stay', query: '2 Jenkins Street, Dunedin, New Zealand', drive: '開車約 2 小時'}
                        ]
                    },
                    {
                        date: '2025-12-28',
                        title: '但尼丁與企鵝',
                        route: '但尼丁 -> 奧瑪魯',
                        km: '120km',
                        driveTime: '1.5h',
                        stay: '49 Arun Street, Oamaru',
                        stayAddr: '49 Arun Street, Oamaru, New Zealand',
                        activities: [
                            {name: '但尼丁火車站', desc: '參觀復古車站。', type: 'view', query: 'Dunedin Railway Station', drive: '開車約 10 分'},
                            {name: '鮑德溫街', desc: '世界最斜街道。', type: 'view', query: 'Baldwin Street', drive: '開車約 10 分'},
                            {name: 'Tunnel Beach', desc: '走到盡頭停車場，健行來回1小時。', type: 'hike', query: 'Tunnel Beach Track', drive: '開車約 25 分'},
                            {name: '摩拉基圓石', desc: '經過龍珠石。', type: 'view', query: 'Moeraki Boulders Beach', drive: '開車約 1 小時'},
                            {name: '奧瑪魯老街', desc: '維多利亞風情(Heritage Precinct)。', type: 'view', query: 'Oamaru\'s Heritage Precinct', drive: '開車約 40 分'},
                            {name: '企鵝歸巢', desc: '20:04 集合。South Hill。', type: 'view', query: '17 Waterfront Road, South Hill, Oamaru 9400', drive: '開車約 3 分'},
                            {name: '回程', desc: '看完企鵝回民宿休息。', type: 'transport', query: '49 Arun Street, Oamaru, New Zealand', drive: '開車約 5 分'}
                        ]
                    },
                    {
                        date: '2025-12-29',
                        title: '返回基督城',
                        route: '奧瑪魯 -> 基督城',
                        km: '250km',
                        driveTime: '3h',
                        stay: '5/54 Stewart St, CHC',
                        stayAddr: '54 Stewart Street, Christchurch, New Zealand',
                        activities: [
                            {name: 'Caroline Bay', desc: '看海豹(看運氣)、玫瑰園。', type: 'view', query: 'Caroline Bay, Timaru 7910', drive: '開車約 1 小時'},
                            {name: '入住基督城', desc: '連住三天。', type: 'stay', query: '54 Stewart Street, Christchurch, New Zealand', drive: '開車約 2 小時'}
                        ]
                    },
                    {
                        date: '2025-12-30',
                        title: '凱庫拉賞鯨',
                        route: '基督城 <-> 凱庫拉',
                        km: '360km(來回)',
                        driveTime: '5h',
                        stay: '5/54 Stewart St, CHC',
                        stayAddr: '54 Stewart Street, Christchurch, New Zealand',
                        activities: [
                            {name: '出發', desc: '07:40 出發。開2.5小時。', type: 'transport', nav: false},
                            {name: '賞鯨報到', desc: '10:45 前到達。Whaleway Station Road。', type: 'fun', query: 'Whaleway Station Road, Kaikōura 7340', drive: '開車約 2.5 小時'},
                            {name: '午餐', desc: 'Café Encounter 或 Seafood BBQ。', type: 'food', query: '96 Esplanade, Kaikōura 7300', drive: '開車約 5 分'},
                            {name: '看海豹', desc: 'Kaikoura Peninsula Walkway。', type: 'view', query: 'Kaikoura Peninsula Walkway, Kaikoura Peninsula, Kaikoura 7300', drive: '開車約 10 分'},
                            {name: '回程', desc: '回民宿及還車。', type: 'transport', query: '54 Stewart Street, Christchurch', drive: '開車約 2.5 小時'}
                        ]
                    },
                    {
                        date: '2025-12-31',
                        title: '基督城跨年',
                        route: '基督城自由行',
                        km: '-',
                        driveTime: '-',
                        stay: '5/54 Stewart St, CHC',
                        stayAddr: '54 Stewart Street, Christchurch, New Zealand',
                        activities: [
                            {name: '市區漫遊', desc: '植物園、雅芳河撐船、美術館、市集。', type: 'view', nav: false},
                            {name: '跨年音樂會', desc: 'North Hagley Park。位子不擠但會冷。', type: 'fun', query: '14 Riccarton Avenue, Christchurch Central City, Christchurch 8011'},
                            {name: '回程', desc: '跨年結束回民宿。', type: 'transport', query: '54 Stewart Street, Christchurch', drive: '開車約 10 分'}
                        ]
                    },
                    {
                        date: '2026-01-01',
                        title: '飛往北島',
                        route: 'CHC -> WLG -> Ohakune',
                        km: '290km',
                        driveTime: '4h',
                        stay: '94 Clyde Street, Ohakune',
                        stayAddr: '94 Clyde Street, Ohakune 4625, New Zealand',
                        activities: [
                            {name: '前往機場', desc: '09:30 坐車去機場。', type: 'transport', query: 'Christchurch Airport'},
                            {name: '飛往威靈頓', desc: '12:15 飛 -> 13:30 到。', type: 'transport', nav: false},
                            {name: '租車北上', desc: '14:30 租完車。確認延後還車計價。', type: 'transport', query: 'Wellington Airport Car Rental'},
                            {name: '前往 Ohakune', desc: '開4小時。中途 Wild Bean Café 休息 (3.5h)，若去北帕默斯頓維多利亞花園則 4h。', type: 'transport', nav: false, drive: '開車約 4 小時'},
                            {name: '入住', desc: '胡蘿蔔公園後面。無冷氣有風扇。', type: 'stay', query: '94 Clyde Street, Ohakune 4625'}
                        ]
                    },
                    {
                        date: '2026-01-02',
                        title: '火山與陶波',
                        route: 'Ohakune -> 陶波',
                        km: '150km',
                        driveTime: '2h',
                        stay: '10 Wiremu St, Tūrangi',
                        stayAddr: '10 Wiremu Street, Turangi, New Zealand',
                        activities: [
                            {name: 'Ruapehu 火山', desc: 'Iwikau Village 看全貌。Meads Wall 步道(15分)。', type: 'view', query: 'Iwikau Village', drive: '開車約 45 分'},
                            {name: '瀑布步道', desc: 'Tawhai Falls (20分) 或 Taranaki Falls (2-3小時)。', type: 'hike', query: 'Taranaki Falls Track'},
                            {name: '前往陶波', desc: '下午開 1.5 小時。', type: 'transport', nav: false, drive: '開車約 1.5 小時'},
                            {name: '湖卡瀑布', desc: '觀賞壯觀的湖卡瀑布。', type: 'view', query: 'Huka Falls'},
                            {name: 'Huka Prawn Park', desc: '撈蝦烤蝦、吃蒜香奶油蝦、蝦漢堡蝦沙拉。', type: 'fun', query: 'Huka Prawn Park'}
                        ]
                    },
                    {
                        date: '2026-01-03',
                        title: '羅托魯瓦探險',
                        route: '陶波 -> 羅托魯瓦',
                        km: '80km',
                        driveTime: '1h',
                        stay: '4 Westbourne Ave, Rotorua',
                        stayAddr: '4 Westbourne Avenue, Rotorua, New Zealand',
                        activities: [
                            {name: '前往羅托魯瓦', desc: '經 Wildwood Farm 花卉農場。', type: 'transport', query: 'Wildwood Farm', drive: '開車約 1 小時'},
                            {name: 'Skyline', desc: '空中纜車+5圈滑板車。若今日有空可先去 Heritage 農場。', type: 'fun', query: 'Skyline Rotorua'},
                            {name: '紅木森林', desc: '夜間點燈步道 (可彈性安排在 1/4 或 1/5 晚上)。', type: 'view', query: 'Redwoods Treewalk'}
                        ]
                    },
                    {
                        date: '2026-01-04',
                        title: '樹冠與地熱',
                        route: '羅托魯瓦一日遊',
                        km: '-',
                        driveTime: '-',
                        stay: '4 Westbourne Ave, Rotorua',
                        stayAddr: '4 Westbourne Avenue, Rotorua, New Zealand',
                        activities: [
                            {name: '樹冠層滑索', desc: '09:15 Canopy Tours (3.5小時)。', type: 'fun', query: 'Rotorua Canopy Tours'},
                            {name: '地獄之門', desc: '午餐後去地熱區及泥浴體驗。', type: 'view', query: 'Hells Gate Geothermal Park'},
                            {name: 'Heritage 農場', desc: '16:00 前到達 (來不及可致電延至 16:30)。若瓦納卡看過羊駝可放棄。', type: 'fun', query: 'Agrodome'}
                        ]
                    },
                    {
                        date: '2026-01-05',
                        title: '間歇泉與滾球',
                        route: '羅托魯瓦一日遊',
                        km: '-',
                        driveTime: '-',
                        stay: '4 Westbourne Ave, Rotorua',
                        stayAddr: '4 Westbourne Avenue, Rotorua, New Zealand',
                        activities: [
                            {name: 'Lady Knox 間歇泉', desc: '10:15 噴發，09:30 前卡位。', type: 'view', query: 'Lady Knox Geyser'},
                            {name: 'Wai-O-Tapu', desc: '走彩色地熱區 1.5-2 小時。', type: 'view', query: 'Wai-O-Tapu Thermal Wonderland'},
                            {name: 'ZORB 水球', desc: '下午玩滾球。留一小時可體驗二次。帶GoPro、浴巾。', type: 'fun', query: 'ZORB Rotorua'}
                        ]
                    },
                    {
                        date: '2026-01-06',
                        title: '前往奧克蘭',
                        route: '羅托魯瓦 -> 奧克蘭',
                        km: '230km',
                        driveTime: '3h',
                        stay: '64 Federal St, Auckland',
                        stayAddr: '64 Federal Street, Auckland, New Zealand',
                        activities: [
                            {name: '前往奧克蘭機場', desc: '經 Hamilton 向日葵農場。', type: 'transport', query: 'Auckland Airport', drive: '開車約 3 小時'},
                            {name: '還車', desc: '14:30 左右還車。入住。', type: 'transport', nav: false}
                        ]
                    },
                    {
                        date: '2026-01-07',
                        title: '奧克蘭市區',
                        route: '奧克蘭自由行',
                        km: '-',
                        driveTime: '-',
                        stay: '64 Federal St, Auckland',
                        stayAddr: '64 Federal Street, Auckland, New Zealand',
                        activities: [
                            {name: '市區觀光', desc: '皇后街、天空塔、Britomart。', type: 'shop', query: 'Queen Street, Auckland'},
                            {name: '海港橋', desc: '考慮攀登或蹦極。', type: 'fun', query: 'Auckland Harbour Bridge'},
                            {name: '預約車子', desc: '記得預約明天去機場的車。', type: 'transport', nav: false}
                        ]
                    },
                    {
                        date: '2026-01-08',
                        title: '回家囉',
                        route: 'AKL -> TPE',
                        km: '-',
                        driveTime: '-',
                        stay: '-',
                        activities: [
                            {name: '前往機場', desc: '搭機返台。', type: 'transport', query: 'Auckland Airport'},
                            {name: '起飛', desc: '10:45 飛機。', type: 'transport', nav: false}
                        ]
                    }
                ],

                init() {
                    this.updateCurrentDay();
                    this.scrollToToday();
                },

                updateCurrentDay() {
                    const startDate = new Date('2025-12-21');
                    const today = new Date();
                    if (isNaN(today.getTime())) return;
                    
                    const diffTime = today - startDate;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
                    this.currentDayNum = diffDays;
                },

                scrollToToday() {
                    const today = new Date();
                    const year = today.getFullYear();
                    const month = String(today.getMonth() + 1).padStart(2, '0');
                    const day = String(today.getDate()).padStart(2, '0');
                    const dateStr = `${year}-${month}-${day}`;

                    const index = this.days.findIndex(d => d.date === dateStr);
                    
                    if (index !== -1) {
                        this.openDay = index;
                        // Wait for render, then scroll to the specific day card
                        setTimeout(() => {
                            const element = document.getElementById('day-' + index);
                            if (element) {
                                // Calculate offset to handle sticky header (approx 100px)
                                const y = element.getBoundingClientRect().top + window.scrollY - 110; 
                                window.scrollTo({top: y, behavior: 'smooth'});
                            }
                        }, 500);
                    }
                },

                toggleDay(index) {
                    this.openDay = (this.openDay === index) ? -1 : index;
                },

                formatDate(dateStr) {
                    const date = new Date(dateStr);
                    return date.getDate();
                },
                
                formatMonth(dateStr) {
                    const date = new Date(dateStr);
                    return date.toLocaleString('default', { month: 'short' });
                },
                
                isPast(dateStr) {
                    const date = new Date(dateStr);
                    const today = new Date(); // Use actual today for styling
                    return date < today;
                },

                getMapLink(query) {
                    if (!query) return '#';
                    return `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
                },
                
                getDotColor(type) {
                    const map = {
                        transport: 'dot-gray',
                        food: 'dot-orange',
                        stay: 'dot-indigo',
                        view: 'dot-green',
                        fun: 'dot-red',
                        shop: 'dot-purple',
                        star: 'dot-blue',
                        hike: 'dot-emerald'
                    };
                    return map[type] || 'dot-gray';
                }
            }));
        });
    </script>

    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>

    <style>
        /* === RESET & VARIABLES === */
        :root {
            --primary: #5D7E68;
            --secondary: #D4A373;
            --bg: #F9F7F2;
            --text-main: #2C3E50;
            --text-light: #64748B;
            --card-bg: rgba(255, 255, 255, 0.95);
            --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
            /* No navigation bar, less padding needed */
            padding-bottom: calc(40px + var(--safe-bottom)); 
            min-height: 100vh;
            min-height: 100dvh;
        }

        [x-cloak] { display: none !important; }

        /* === TYPOGRAPHY === */
        h1, h2, h3, h4 { margin: 0; font-weight: 700; }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        /* === LAYOUT UTILS === */
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .flex-1 { flex: 1; }
        .shrink-0 { flex-shrink: 0; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .hidden { display: none; }
        .block { display: block; }
        .w-full { width: 100%; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mr-2 { margin-right: 0.5rem; }
        .ml-2 { margin-left: 0.5rem; }
        .p-4 { padding: 1rem; }
        .p-5 { padding: 1.25rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        
        /* === COMPONENTS === */
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(249, 247, 242, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            z-index: 50;
            padding-top: calc(10px + var(--safe-top));
            padding-bottom: 10px;
            padding-left: 20px;
            padding-right: 20px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            max-width: 600px;
            margin: 0 auto;
        }

        .subtitle { font-size: 10px; letter-spacing: 2px; color: var(--primary); text-transform: uppercase; font-weight: 700; }
        .title { font-size: 24px; color: #333; }
        .day-counter { font-size: 24px; color: var(--secondary); font-weight: 700; }

        /* Main Container */
        main {
            margin-top: calc(100px + var(--safe-top)); /* Slightly more space */
            padding: 0 16px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Card Style */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            margin-bottom: 16px;
            overflow: hidden;
            transition: transform 0.2s;
        }
        
        .card.expanded {
            box-shadow: 0 10px 30px rgba(0,0,0,0.06);
            border-color: var(--primary);
        }

        .card.past {
            opacity: 0.7;
            filter: grayscale(0.5);
        }

        /* Date Badge */
        .date-badge {
            width: 50px;
            height: 50px;
            background: #f3f4f6;
            border-radius: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .date-badge.active { background: var(--primary); color: #fff; }
        .date-badge span:first-child { font-size: 10px; text-transform: uppercase; font-weight: 700; }
        .date-badge span:last-child { font-size: 20px; font-weight: 700; line-height: 1; }

        /* Flight Card Special */
        .flight-card {
            border-left: 6px solid var(--primary); 
            border-left-color: #6B8E9B; 
        }
        
        .flight-line {
            height: 2px;
            background: #e5e7eb;
            position: relative;
            margin: 0 10px;
            flex: 1;
        }
        .flight-line::before, .flight-line::after {
            content: ''; position: absolute; top: -3px; width: 8px; height: 8px; border-radius: 50%;
        }
        .flight-line::before { left: 0; background: #ccc; }
        .flight-line::after { right: 0; background: #6B8E9B; }
        .plane-icon-center { position: absolute; top: -8px; left: 50%; transform: translateX(-50%); color: #6B8E9B; font-size: 12px;}

        /* Timeline */
        .timeline-container {
            position: relative;
            padding-left: 16px;
            margin-left: 8px;
        }
        
        .timeline-item {
            position: relative;
            padding-bottom: 24px;
        }
        
        .timeline-line {
            position: absolute;
            left: 7px;
            top: 15px;
            bottom: -15px;
            width: 2px;
            background: #e5e7eb;
        }
        .timeline-item:last-child .timeline-line { display: none; }

        .timeline-dot {
            position: absolute;
            left: -2px;
            top: 4px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 3px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 10;
        }

        /* Dot Colors */
        .dot-gray { background: #9ca3af; }
        .dot-orange { background: #fb923c; }
        .dot-indigo { background: #6366f1; }
        .dot-green { background: #5D7E68; }
        .dot-red { background: #ef4444; }
        .dot-purple { background: #c084fc; }
        .dot-blue { background: #1e40af; }
        .dot-emerald { background: #059669; }

        .activity-content {
            padding-left: 24px;
            display: flex;
            justify-content: space-between;
            align-items: start;
        }

        /* Map Button */
        .map-btn {
            width: 32px;
            height: 32px;
            background: #f9fafb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            text-decoration: none;
            flex-shrink: 0;
            margin-left: 10px;
            transition: all 0.2s;
        }
        .map-btn:active { background: var(--primary); color: #fff; }

        /* Tip Box */
        .tip-box {
            display: inline-flex;
            align-items: flex-start;
            background: #fffbeb;
            border: 1px solid #fcd34d;
            color: #92400e;
            font-size: 11px;
            padding: 6px 10px;
            border-radius: 8px;
            margin-top: 8px;
            line-height: 1.4;
        }
        
        /* Drive Time Box */
        .drive-box {
            font-size: 10px;
            color: #666;
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 4px;
            display: inline-block;
        }

    </style>
</head>
<body x-data="itineraryApp" x-cloak>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div>
                <div class="subtitle">New Zealand 2025-26</div>
                <h1 class="title font-serif">紐西蘭・夏日漫遊</h1>
            </div>
            <div class="text-right">
                <div style="font-size: 10px; color: #999; text-transform: uppercase;">Day</div>
                <div class="day-counter font-serif" x-text="currentDayNum"></div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>

        <!-- Flight Card -->
        <div class="card flight-card p-5">
            <div class="flex justify-between items-center mb-4">
                <span style="background:#6B8E9B; color:white; font-size:10px; font-weight:bold; padding:2px 6px; border-radius:4px;">FLIGHT</span>
                <span style="font-size:12px; color:#999; font-family:monospace;">TRIP START</span>
            </div>
            
            <div class="flex items-center justify-between">
                <div class="text-center">
                    <div style="font-size:24px; font-weight:700;">TPE</div>
                    <div style="font-size:12px; color:#666;">台北</div>
                </div>
                
                <div class="flight-line">
                    <i class="fa-solid fa-plane plane-icon-center"></i>
                </div>
                
                <div class="text-center">
                    <div style="font-size:24px; font-weight:700;">AKL</div>
                    <div style="font-size:12px; color:#666;">奧克蘭</div>
                </div>
            </div>

            <div class="tip-box" style="width:100%; border-color:#fecaca; background:#fef2f2; color:#b91c1c; margin-top:16px;">
                <i class="fa-solid fa-triangle-exclamation" style="margin-right:6px; margin-top:2px;"></i> 
                <div>
                    <span style="font-weight:bold; display:block;">轉機重要提醒</span>
                    在奧克蘭必須 <span style="text-decoration:underline;">提領行李</span> 並重新check-in國內線！
                </div>
            </div>
        </div>

        <!-- Days List -->
        <template x-for="(day, index) in days" :key="index">
            <div :id="'day-' + index" class="card" :class="{'expanded': openDay === index, 'past': isPast(day.date) && openDay !== index}">
                
                <!-- Card Header -->
                <div @click="toggleDay(index)" class="p-5 flex items-center justify-between" style="cursor: pointer;">
                    <div class="flex items-center" style="gap: 16px;">
                        <div class="date-badge" :class="{'active': openDay === index}">
                            <span x-text="formatMonth(day.date)"></span>
                            <span x-text="formatDate(day.date)"></span>
                        </div>
                        <div style="min-width: 0; flex: 1;"> <!-- Fix for text overflow -->
                            <h3 style="font-size:16px; margin-bottom:4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" x-text="day.title"></h3>
                            <div style="font-size:12px; color:#666; display:flex; items-align:center;">
                                <span style="width:6px; height:6px; background:var(--secondary); border-radius:50%; margin-right:6px; margin-top:5px;"></span>
                                <span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" x-text="day.route"></span>
                            </div>
                        </div>
                    </div>
                    <i class="fa-solid fa-chevron-down" style="color:#ccc; transition:0.3s;" :style="openDay === index ? 'transform:rotate(180deg); color:var(--primary)' : ''"></i>
                </div>

                <!-- Card Body -->
                <div x-show="openDay === index" x-collapse style="border-top:1px solid #f3f4f6;">
                    <!-- Transport Info -->
                    <div class="px-4 py-2" style="background:#f9fafb; display:flex; gap:20px; font-size:12px; color:#666; font-weight:500;">
                        <span x-show="day.km !== '-'"><i class="fa-solid fa-road mr-2"></i> <span x-text="day.km"></span></span>
                        <span x-show="day.driveTime !== '-'"><i class="fa-regular fa-clock mr-2"></i> <span x-text="day.driveTime"></span></span>
                    </div>

                    <!-- Timeline -->
                    <div class="p-5">
                        <div class="timeline-container">
                            <template x-for="(item, idx) in day.activities">
                                <div class="timeline-item">
                                    <div class="timeline-line"></div>
                                    <div class="timeline-dot" :class="getDotColor(item.type)"></div>
                                    
                                    <div class="activity-content">
                                        <div style="flex:1; min-width:0;">
                                            <!-- Drive Time Badge (Displayed above activity) -->
                                            <div x-show="item.drive" class="drive-box" style="margin-bottom: 6px;">
                                                <i class="fa-solid fa-car-side" style="margin-right: 4px;"></i>
                                                <span x-text="item.drive"></span>
                                            </div>

                                            <div style="font-weight:700; font-size:14px; margin-bottom:4px;" x-text="item.name"></div>
                                            <div style="font-size:12px; color:#666; line-height:1.5;" x-text="item.desc"></div>
                                            
                                            <div x-show="item.tip" class="tip-box">
                                                <i class="fa-solid fa-lightbulb" style="margin-right:6px; color:#f59e0b;"></i>
                                                <span x-text="item.tip"></span>
                                            </div>
                                        </div>
                                        <!-- Conditional Nav Button -->
                                        <a x-show="item.nav !== false" :href="getMapLink(item.query || item.name)" target="_blank" class="map-btn">
                                            <i class="fa-solid fa-location-arrow" style="font-size:12px;"></i>
                                        </a>
                                    </div>
                                </div>
                            </template>
                        </div>

                        <!-- Stay Info -->
                        <div x-show="day.stay && day.stay !== '-'" style="margin-top:10px; padding-top:16px; border-top:1px solid #f3f4f6;">
                            <div style="display:flex; background:#eef2ff; border-radius:12px; padding:12px; border:1px solid #e0e7ff;">
                                <div style="width:32px; height:32px; background:#e0e7ff; color:#6366f1; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:12px;">
                                    <i class="fa-solid fa-bed" style="font-size:12px;"></i>
                                </div>
                                <div style="flex:1;">
                                    <div style="font-size:10px; font-weight:700; color:#818cf8; text-transform:uppercase;">Tonight's Stay</div>
                                    <div style="font-size:14px; font-weight:700; color:#333;" x-text="day.stay"></div>
                                    <div x-show="day.stayAddr" style="font-size:12px; color:#666; margin-top:4px;" x-text="day.stayAddr"></div>
                                    <a x-show="day.stayAddr" :href="getMapLink(day.stayAddr)" target="_blank" style="display:inline-block; margin-top:8px; font-size:12px; font-weight:700; color:#6366f1; text-decoration:none;">導航去住宿 &rarr;</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </template>
        
        <!-- Trip End Card -->
        <div class="card flight-card p-5" style="margin-top: 20px;">
            <div class="flex justify-between items-center mb-4">
                <span style="background:#6B8E9B; color:white; font-size:10px; font-weight:bold; padding:2px 6px; border-radius:4px;">FLIGHT</span>
                <span style="font-size:12px; color:#999; font-family:monospace;">TRIP END</span>
            </div>
            <div class="flex items-center justify-between">
                <div class="text-center">
                    <div style="font-size:24px; font-weight:700;">AKL</div>
                    <div style="font-size:12px; color:#666;">奧克蘭</div>
                </div>
                <div class="flight-line">
                    <i class="fa-solid fa-plane plane-icon-center" style="transform: translateX(-50%) rotate(180deg);"></i>
                </div>
                <div class="text-center">
                    <div style="font-size:24px; font-weight:700;">TPE</div>
                    <div style="font-size:12px; color:#666;">台北</div>
                </div>
            </div>
            <div class="text-center mt-4" style="font-size:12px; color:#666;">
                <i class="fa-regular fa-clock mr-1"></i> 10:45 起飛
            </div>
        </div>

        <div style="height: 40px;"></div>

    </main>

</body>
</html>
